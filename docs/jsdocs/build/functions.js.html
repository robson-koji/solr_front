

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: functions.js | Javascript Docs Solr Front</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: 160px; height: 52px">
        
            <a href="/buscador/docs" rel="noopener noreferrer" target="_blank">
                <img src="/static-files/solr_front/img/logo_buscador.jpg" width="100%" height="100%">
            </a>
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Javascript Docs Solr Front</a></h1>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
        <ol class="lnb-tab">
            <li id="api-tab">
                <a href="#"><h4>API</h4></a>
            </li>
            <li id="examples-tab">
                <a href="#"><h4>Tutorias</h4></a>
            </li>
        </ol>
    
    <div class="lnb-api hidden"><h3>Modules</h3><ul><li><a href="module-solr_front__bv_d3.html">solr_front::bv_d3</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:solr_front::bv_d3_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-solr_front__bv_d3.html#~json_d3_glb">json_d3_glb</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-solr_front__bv_d3.html#~AnualChart">AnualChart</a></li><li><a href="module-solr_front__bv_d3.html#~barChart">barChart</a></li><li><a href="module-solr_front__bv_d3.html#~geraCharts">geraCharts</a></li><li><a href="module-solr_front__bv_d3.html#~getRender">getRender</a></li><li><a href="module-solr_front__bv_d3.html#~halfPieChart">halfPieChart</a></li><li><a href="module-solr_front__bv_d3.html#~MensalChart">MensalChart</a></li><li><a href="module-solr_front__bv_d3.html#~pegaLabel">pegaLabel</a></li><li><a href="module-solr_front__bv_d3.html#~temporalChart">temporalChart</a></li></ul></div></li><li><a href="module-solr_front__bv_facet.html">solr_front::bv_facet</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:solr_front::bv_facet_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-solr_front__bv_facet.html#~selectedFacets">selectedFacets</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-solr_front__bv_facet.html#~apresentaFacets">apresentaFacets</a></li><li><a href="module-solr_front__bv_facet.html#~constroiComponentFacetsButtons">constroiComponentFacetsButtons</a></li><li><a href="module-solr_front__bv_facet.html#~geraDropdownfacets">geraDropdownfacets</a></li><li><a href="module-solr_front__bv_facet.html#~incluiTags">incluiTags</a></li><li><a href="module-solr_front__bv_facet.html#~limpaLabelSolr">limpaLabelSolr</a></li><li><a href="module-solr_front__bv_facet.html#~makeDataComponentFacet">makeDataComponentFacet</a></li><li><a href="module-solr_front__bv_facet.html#~removeAllElementSelectedFacets">removeAllElementSelectedFacets</a></li></ul></div></li><li><a href="module-solr_front__bv_querybuilder.html">solr_front::bv_querybuilder</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:solr_front::bv_querybuilder_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-solr_front__bv_querybuilder.html#~instituicao_sede_opt">instituicao_sede_opt</a></li><li><a href="module-solr_front__bv_querybuilder.html#~selecionados">selecionados</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="module-solr_front__bv_querybuilder.html#~ajax_solr">ajax_solr</a></li><li><a href="module-solr_front__bv_querybuilder.html#~geraRoot">geraRoot</a></li><li><a href="module-solr_front__bv_querybuilder.html#~getBuscaRealizada">getBuscaRealizada</a></li><li><a href="module-solr_front__bv_querybuilder.html#~injectAutocompleteTag">injectAutocompleteTag</a></li><li><a href="module-solr_front__bv_querybuilder.html#~reverse_filter">reverse_filter</a></li></ul></div></li><li><a href="module-solr_front__functions.html">solr_front::functions</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:solr_front::functions_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-solr_front__functions.html#~apresentaPublicacaoes">apresentaPublicacaoes</a></li><li><a href="module-solr_front__functions.html#~collectionsRelacionadas">collectionsRelacionadas</a></li><li><a href="module-solr_front__functions.html#~constroiComponentDocumentos">constroiComponentDocumentos</a></li><li><a href="module-solr_front__functions.html#~constroiComponentTotalizadores">constroiComponentTotalizadores</a></li><li><a href="module-solr_front__functions.html#~constroiComponentTotalizadoresRelacionados">constroiComponentTotalizadoresRelacionados</a></li><li><a href="module-solr_front__functions.html#~criaSelectPivotTable">criaSelectPivotTable</a></li><li><a href="module-solr_front__functions.html#~criaSelectSankeyChart">criaSelectSankeyChart</a></li><li><a href="module-solr_front__functions.html#~define_busca">define_busca</a></li><li><a href="module-solr_front__functions.html#~getData">getData</a></li><li><a href="module-solr_front__functions.html#~getFakeData">getFakeData</a></li><li><a href="module-solr_front__functions.html#~getInitialSearch">getInitialSearch</a></li><li><a href="module-solr_front__functions.html#~getTotalizadores">getTotalizadores</a></li><li><a href="module-solr_front__functions.html#~montaTotal">montaTotal</a></li></ul></div></li><li><a href="module-solr_front__main.html">solr_front::main</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:solr_front::main_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="module-solr_front__main.html#~jsonPrettyPrint">jsonPrettyPrint</a></li></ul></div></li><li><a href="module-solr_front__utils.html">solr_front::utils</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="module:solr_front::utils_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="module-solr_front__utils.html#~contains">contains</a></li><li><a href="module-solr_front__utils.html#~extractLast">extractLast</a></li><li><a href="module-solr_front__utils.html#~htmlToElement">htmlToElement</a></li><li><a href="module-solr_front__utils.html#~shuffle">shuffle</a></li><li><a href="module-solr_front__utils.html#~split">split</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Global</h3><ul><li><a href="global.html#Component">Component</a></li><li><a href="global.html#DocsComponent">DocsComponent</a></li><li><a href="global.html#DropdownFormComponentExec">DropdownFormComponentExec</a></li><li><a href="global.html#FacetComponentExec">FacetComponentExec</a></li><li><a href="global.html#TotaisComponent">TotaisComponent</a></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code> /**
* @file Funções da aplicação
*
* #### Existem 4 chamadas ajax
*
* - 1 para carregar o autocomplete do querybuilder.
*
* - 1 para a busca principal
*
* - 1 para a caixa de pesquisa
*
* - 1 para o grafico multifacet
*
* @module solr_front::functions
*
*/

 /**
* Funcao principal de renderizacao da pagina.
* @param {JSON} data - Json contendo facets
*/
function montaTotal(data){

    var resultado_number = '&lt;h3 class="title_secondary">Encontramos &lt;/h3> '+
                            '&lt;div class="results">'+
                                ' &lt;p> ' + data['response']['numFound'] + '&lt;span> documentos em &lt;/span>' + collection_label +
                            '&lt;/div>'
    // limpa resposta anterior se houver
    $('#resultado_number').html('')
    $('#resultado_number').append(resultado_number);

    var g = new GroupComponent()
    g.add(new DropdownFormComponentExec({
      'id': 'node',
      // usando interface padrão info_icon
      // 'click_interface': '&lt;button>Interface&lt;/button>',
      'fields': [
        // pk deve corresponder ao field do vertice
        {'id' : 'title',
        'pk' : 'title',
        'label' : 'Titulo',
        'type': 'text',
        'mode': 'inline',
        'initial_data' : vertice['title'],
        'url_ajax': 'node_edit'},

        {'id' : 'description',
        'pk' : 'description',
        'label' : 'Descrição',
        'type': 'textarea',
        'mode': 'inline',
        'initial_data' : vertice['description'],
        'url_ajax': 'node_edit'},
      ],
     }, 'resultado_number'))

    g.renderExec()

    $('#resultado_number').css('display', '-webkit-box')

    $('#titulo').editable();
    $('#descricao').editable();
    // inicializa popover
    // $('[data-toggle="popover"]').popover();
}

var from_ajax = {}//variavel de escopo global para armazenar dados do ajax e manter em memoria

/**
*
* Faz a principal chamada Ajax no servidor.
* Qdo essa fnc eh chamada ela pode receber dados estaticos na inicializacao
* e carregar todos projetos e bolsas. Ainda pode receber estaticos para teste.
*
* Se nao receber dados estaticos, a funcao recupera no Querybuilder a busca realizada
* e faz request no servidor.
*
* No sucesso chama a montagem da pagina atraves de funcoes especificas, comecando
* pelo esqueleto e incluindo os demais elementos.
* Os respectivos elements sao realizados outros  ajax para recuperar os dados
* da cx de pesquisa e para o grafico interativo.
*
* @param {String} busca_realizada_str - String de busca realizada no queryBuilder
*
*
*/
function getData(busca_realizada_str){

  busca_realizada = define_busca(busca_realizada_str);

  if (!$.isEmptyObject(busca_realizada)) {
    var url =  home_sf_rurl + bv_collection + '/' + id_collection + '/'
    var url_back = url + 'params/'

    $.ajax({
      url: url,
      type: 'post',
      dataType: 'json',
      data: JSON.stringify(getBuscaRealizada({})),

      headers: {
        "cache-control": "no-cache",
        'X-Requested-With': 'XMLHttpRequest',
        "Content-Type" : "application/json; charset=utf-8",
        "Accept" : "application/json",
        'X-CSRFToken': csrf //a varive  l csrf provem da pagina html
      },

      success: function (data) {

        if (data['status']  == 409 || data['status']  == 500){
          $('#loader_screen').hide()
            if (data['log']){
              console.log('Erro de indexação: '+ data['log'])
            }
          error_409_getdata(data, url_back);
          return;
        }
        else {
          var loader = document.getElementById('loader_screen')

          hiden_exec(loader,function (){
            // variavel global usada para reconstruir facets fora do getData
            from_ajax['hierarquia'] = data['facet_counts']['hierarquico']
            constroiComponentFacetsButtons(from_ajax['hierarquia'])
          })
          montaTotal(data)

          $('.modal-backdrop').remove()

          getTotalizadores()
          collectionsRelacionadas()
          if (omite_secoes.indexOf('stackedbarchart') === -1){
            recuperaGraficoDuplo(busca_realizada)
          }
          if (omite_secoes.indexOf('sankey') === -1){
            recuperaSankeyChart(busca_realizada)
          }
          if (omite_secoes.indexOf('pivot_table') === -1){
            recuperaPivotTable(busca_realizada)
          }
          if (omite_secoes.indexOf('bubblechart') === -1){
            recuperaBubbleChart(busca_realizada)
          }
          if (omite_secoes.indexOf('wordcloud') === -1){
            recuperaWordCloudChart(busca_realizada)
          }
          $(".group_half_pie_chart").empty()
          geraCharts(data.facet_counts.hierarquico)
        }
      },

    });

  }
}

/*
* Consulta endpoint no server para verificar task sendo
* processada utilizando o id da task do celery
*
* !! necessario implementar função de sucesso !!
*
*/
function consulta_pedido(id){

  var url =  home_sf_rurl + 'consulta_pedido/'

  $.ajax({
       url: url,
       type: 'get',
       dataType: 'json',
       data: {'id': id},
       headers: {
          "cache-control": "no-cache",
          'X-Requested-With': 'XMLHttpRequest',
          "Content-Type" : "application/json; charset=utf-8",
          "Accept" : "application/json",
          'X-CSRFToken': csrf //a varive  l csrf provem da pagina html
        },
       success: function (data) {
         alert(data.status)
       },

     });
 }

/*
* Altera visibilidade de elemento aplicando um callback,
* renderizando a visibilidade no dom antes de executar função de callback
*/
function hiden_exec(element, callback){
    element.style.display = 'none'

    if (callback &amp;&amp; typeof(callback) === "function") {
      // maneira encontrada para renderizar dom antes de executar callback
        setTimeout(callback, 1)
    }
}

 /*
* Adiciona facets ao clicar em um facet; elemento &lt;li>
* Parece que nao estah usando!!!

*/
function clickFacet(elemento) {
    var parent = $(elemento).parent().attr('valor');
    var valor = $(elemento).attr('valor');

    // Se jah existe a chave no json, appenda na lista caso o elemento
    // ainda nao exista na lista.
    if(selectedFacets.hasOwnProperty(parent)){
      if (!$.inArray(valor, selectedFacets[parent]) > -1){
        selectedFacets[parent].push(valor)
      }
    }
    // Se nao existe a chave no json, cria a chave e inicializa com uma lista
    // e respectivo elemento na lista.
    else{
      selectedFacets[parent] = [valor]
    }
    // Chama funcao que faz chamada Ajax no servidor.
    getData()
}

/**
* Define dados estaticos para uma busca de todas as bolsas e auxilios.
* Utilizado na carga inicial da pagina.
*/
function getInitialSearch(collection){

  // var result = '{"' + collection + '":{"query":null,"ordem":0,"collection":"' + collection + '","selected_facets":{}}}'
  // //debugger

  var result = vertice


  if (result.hasOwnProperty('body_json')){
    //necessario pois a view é dependente que a chave da collection esteja acessivel no primeiro nivel
    return result['body_json']

  }else{

    return result
  }
  //getData(result)
}



/**
* Recupera dados agregados de collections relacionadas
*/
function collectionsRelacionadas(){

  if (typeof busca_realizada_str === 'undefined'){ busca_realizada = getBuscaRealizada() }
  else{ busca_realizada = JSON.parse(busca_realizada_str) }

  var url =  home_sf_rurl + bv_collection + '/' + id_collection + '/relacionadas/';


  var html_funil = function(data){
    count = data['count']
    related_content = data['related_content']

    var htmls = ''
    for (collection in count){

      if (count[collection]['col1']['value'] &lt;= 0){continue}
      var funil_url = '&lt;p>&lt;a href="' + home_sf_rurl + bv_collection + '/' + id_collection  + '/funil/'  + collection + '/' + count[collection]['col2']['parent_hash_querybuilder'] + '"' + ">Clique aqui para analisar " + count[collection]['col2']['value'] + ' ' + count[collection]['col2']['label'] +"&lt;/a>&lt;/p>"

      // Main session for related collections
      htmls += '&lt;div class="col-md-12" style="padding-top:40px">' +
        '&lt;h2 class="title_primary">' +
          count[collection]['col1']['value'] + ' ' +  collection_label + ' -> ' +  count[collection]['col2']['value'] + ' ' + count[collection]['col2']['label'] +
        '&lt;/h2>' +
        funil_url

      // Display content of related collections
      var contents = related_content[collection];

      /*
      for (content in contents['facet']){
        var existe = 0;
        var related_content_html = '&lt;div class="col-md-11 has-col">&lt;div class="content_section__header">';

        related_content_html += '&lt;h3 class="title_secondary">' + contents['facet'][content]['label'] + '&lt;/h3>';
        for (doc in contents['facet'][content]['docs']){
          if (jQuery.isEmptyObject(contents['facet'][content]['docs'][doc])){continue}
          doc = contents['facet'][content]['docs'][doc]
          related_content_html += '&lt;p>&lt;a href ="' + doc["url"] + '">' +  doc["text"] + '&lt;/a>&lt;/p>';
          if (doc["text"] !== ''){ existe = 1}
        }
        related_content_html += '&lt;/div>&lt;/div>';
        if (existe){ // print only if one document has text.
          htmls += related_content_html;
        }
      }
      */
      htmls += '&lt;/div>&lt;hr>';
    }
    return htmls
  }

  $('#loader_resultado_number').show()

  $('#collections_relacionadas').hide()
  $('#collections_relacionadas').empty()


  $.ajax({
       url: url,
       type: 'post',
       dataType: 'json',

       headers: {
          "cache-control": "no-cache",
          'X-Requested-With': 'XMLHttpRequest',
          "Content-Type" : "application/json; charset=utf-8",
          "Accept" : "application/json",
          'X-CSRFToken': csrf //a varivel csrf provem da pagina html
        },

       success: function (data) {
         /*
         data retorna um objeto de collections.
         Cada collection tem um dicionario de totalizadores (conteudos)
         */
         $('.modal-backdrop').remove()



         var html = ''
         for (var d in data) {
           if (Object.keys(data[d]).length === 0 &amp;&amp; data[d].constructor === Object){ continue }
            html = html_funil(data)
          }
          if (html == ''){
            html = '&lt;div class="alert alert-warning" role="alert">' +
                    'Não existem dados de outras collections que se relacionam com esta busca.&lt;div>'
          }
          $('#collections_relacionadas').append(html)
          $('#collections_relacionadas').show()
         $('#loader_resultado_number').hide()
       },
       error: function (xhr, ajaxOptions, thrownError) {
           if(xhr.status==403) {
              console.log(JSON.stringify(xhr) )
           }
         },
       data: JSON.stringify(busca_realizada)
   });

}


/**
* Mostra as ultimas 20 publicacoes.
*/
function apresentaPublicacaoes(docs){
  pub_relacionadas_20 = ''


  for(var i = 0; i &lt; docs.length; i++){
      pub_relacionadas_20 += '&lt;p>' + docs[i]['referencia'] + '&lt;/p>'

      // console.log(docs[i]['referencia'])
  }
  $('#pub_relacionadas_20').empty()
  $('#pub_relacionadas_20').append(pub_relacionadas_20);
}



/**
* Gera blocos totalizadores no front
*/
function getTotalizadores(){
    busca_realizada = getBuscaRealizada()
    // debugger;

    var url =  home_sf_rurl + bv_collection + '/' + id_collection + '/totalizadores/';

    $.ajax({
         url: url,
         type: 'post',
         dataType: 'json',

         headers: {
            "cache-control": "no-cache",
            'X-Requested-With': 'XMLHttpRequest',
            "Content-Type" : "application/json; charset=utf-8",
            "Accept" : "application/json",
            'X-CSRFToken': csrf //a varivel csrf provem da pagina html
          },

         success: function (data) {
           // console.log('Success - Totalizadores da propria collection')
           // console.log(data)
           $('.modal-backdrop').remove()

           constroiComponentDocumentos( data['facet'] )

           // faz join dos objetos e armazena novo objeto na variavel

           var obj = $.extend(data['unique'])
           obj = $.extend(obj, data['sum'])
           obj = $.extend(obj, data['avg'])
           obj = $.extend(obj, data['facet'] )

           // renderiza objeto caso existir dados nele
           constroiComponentTotalizadores(obj)


         },
         error: function (xhr, ajaxOptions, thrownError) {
             if(xhr.status==403) {
                console.log(JSON.stringify(xhr) )
             }
           },
         data: JSON.stringify(busca_realizada)
     });
}


/**
* Monta os Select fields do grafico Sankey
*/
function criaSelectSankeyChart(button){

  // Armazena os valores que jah foram utlziados para nao repetir.
  selects_vals = []
  selects = $(".sankey_options")
      .map(function() {
        selects_vals.push($(this).val())
    })
  selects_vals.splice(-1,1)

  // Recupera o numero de selects para criar o proximo
  var numItems = $('.sankey_options').length -1
  numItems += 1
  var sankeyNivel = 'nivel_' + numItems

  // Cria div antes do botao, para que os selects fiquem "ordenados"
  var button = $(button)

  // Cria o select
  var sel =  '&lt;select class="sankey_options" id="' + sankeyNivel + '">'
  var sel = $(sel)
  $(sel).append($("&lt;option>").attr('value','').text('Selecione uma dimensão'));
  $(sankey_chart_options['options']).each(function() {
    if (! selects_vals.includes(this.value)){
      $(sel).append($("&lt;option>").attr('value',this.value).text( decodeURI(this.label)));
    }
  });

  // Cria div "alert" que acondiciona o select, para poder excluir.
  var dismiss_html = '&lt;a href="#" class="close" data-dismiss="alert" aria-label="close" title="close">×&lt;/a>'
  var div = $('&lt;div class="alert alert-success alert-auto">').insertBefore(button);
  $(div).append(dismiss_html);

  // Adiciona o select a div.
  $(div).append($(sel));

}


/**
* Monta os Select fields da tabela pivo
*/
function criaSelectPivotTable(button){

  // Armazena os valores que jah foram utlziados para nao repetir.
  selects_vals = []
  selects = $(".pivot_options")
      .map(function() {
        selects_vals.push($(this).val())
    })
  selects_vals.splice(-1,1)

  // Recupera o numero de selects para criar o proximo
  var numItems = $('.pivot_options').length -1
  numItems += 1
  var pivotNivel = 'nivel_' + numItems

  // Cria div antes do botao, para que os selects fiquem "ordenados"
  var button = $(button)

  // Cria o select
  var sel =  '&lt;select class="pivot_options" id="' + pivotNivel + '">'
  var sel = $(sel)
  $(sel).append($("&lt;option>").attr('value','').text('Selecione uma dimensão'));
  $(pivot_table_options['options']).each(function() {
    if (! selects_vals.includes(this.value)){
      $(sel).append($("&lt;option>").attr('value',this.value).text( decodeURI(this.label)));
    }
  });

  // Cria div "alert" que acondiciona o select, para poder excluir.
  var dismiss_html = '&lt;a href="#" class="close" data-dismiss="alert" aria-label="close" title="close">×&lt;/a>'
  var div = $('&lt;div class="alert alert-success alert-auto">').insertBefore(button);
  $(div).append(dismiss_html);

  // Adiciona o select a div.
  $(div).append($(sel));

}


/**
* Realiza busca vazia
*/
function getFakeData(){
  var busca_realizada = '{"graph_auxilios":{"query":{"condition":"AND","rules":[{"id":"area","field":"area","type":"string","operator":"equal","value":"Geologia"}],"valid":true},"ordem":0,,"selected_facets":{}}}'
  getData(busca_realizada)
}

/**
* gera variavel de busca utilizada na função GetData
*/
function define_busca(busca_realizada_str){

  if (typeof busca_realizada_str === 'undefined')
  {
    var busca_realizada = getBuscaRealizada()
  }else{
    var busca_realizada = JSON.parse(busca_realizada_str)
  }

  return busca_realizada

}

/**
* gera componentes de blocos com totais
*/
function constroiComponentTotalizadores(obj){

  var g = new GroupComponent()


  for( facet in obj){
    facet = obj[facet]

    if(typeof facet['type'] != 'undefined'){

        if(contains(facet['type'],'main')){

          // debugger;
        g.add(new TotaisComponent({
          'total':facet['numFound'],
          'label':facet['label']},
          'main')
        );

        }
      if( contains(facet['type'], 'secondary') ){


          g.add(new TotaisComponent({
            'total':facet['numFound'],
            'label':facet['label']},
            'secondary')
          );
        }
      }
  }


  g.renderAll(clean=true)


}

/**
* gera componente com blocos de totais de docuemntos relacionados
*/
function constroiComponentTotalizadoresRelacionados(obj){

  var g = new GroupComponent()


  for( facet in obj){
    facet = obj[facet]
    g.add(new TotaisComponent({
      'total':facet['numFound'],
      'label':facet['label']},
      'totais_rel')
    );
  }


  g.renderAll(clean=true)


}

/**
* gera componente que contem links de auxilios e bolsas
* listados e categorizados
*/
function constroiComponentDocumentos(obj){
  var g = new GroupComponent()

  for( facet in obj){
    facet = obj[facet]
    if(facet['type'].indexOf('doc') > -1){
    var links = []
    //gera lista de url
    for(key in facet['docs']){
      var doc = facet['docs'][key]
      if(doc.text){
        links.push( {'url':doc.url, 'titulo':doc.text} )
      }
    }

    //split titulo para separar situacao do label
    var situacao = facet['label'].split('-')[1]
    var titulo = facet['label'].split('-')[0]

    var colunas = 6;
    if ('colunas' in facet){colunas = facet['colunas']}

    //split titulo para separar situacao do label
    var situacao = facet['label'].split('-')[1]
    var titulo = facet['label'].split('-')[0]

    g.add(new DocsComponent({
      'total':facet['numFound'],
      'colunas':colunas,
      'label':titulo,
      'links': links,
      'situacao': situacao }
      ,'documentos'));
    }
  }
  g.renderAll(clean=true)
}
</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="/static-files/solr_front/img/logo_buscador.jpg" style="width: 160px; height: 52px">
    <div class="footer-text">NHN Entertainment. Frontend Development Lab</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
